import{g as J}from"./_commonjsHelpers-CqkleIqs.js";import{e as F}from"./index-C0nYIjA0.js";import{s as K}from"./index-Ch_qCilz.js";function U(t){if(t)throw t}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Q=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)};const H=J(Q);function N(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function W(){const t=[],e={run:n,use:s};return e;function n(...r){let i=-1;const o=r.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);h(null,...r);function h(d,...E){const A=t[++i];let S=-1;if(d){o(d);return}for(;++S<r.length;)(E[S]===null||E[S]===void 0)&&(E[S]=r[S]);r=E,A?X(A,h)(...E):o(null,...E)}}function s(r){if(typeof r!="function")throw new TypeError("Expected `middelware` to be a function, not "+r);return t.push(r),e}}function X(t,e){let n;return s;function s(...o){const h=t.length>o.length;let d;h&&o.push(r);try{d=t.apply(this,o)}catch(E){const A=E;if(h&&n)throw A;return r(A)}h||(d&&d.then&&typeof d.then=="function"?d.then(i,r):d instanceof Error?r(d):i(d))}function r(o,...h){n||(n=!0,e(o,...h))}function i(o){r(null,o)}}class y extends Error{constructor(e,n,s){const r=[null,null];let i={start:{line:null,column:null},end:{line:null,column:null}};if(super(),typeof n=="string"&&(s=n,n=void 0),typeof s=="string"){const o=s.indexOf(":");o===-1?r[1]=s:(r[0]=s.slice(0,o),r[1]=s.slice(o+1))}n&&("type"in n||"position"in n?n.position&&(i=n.position):"start"in n||"end"in n?i=n:("line"in n||"column"in n)&&(i.start=n)),this.name=K(n)||"1:1",this.message=typeof e=="object"?e.message:e,this.stack="",typeof e=="object"&&e.stack&&(this.stack=e.stack),this.reason=this.message,this.fatal,this.line=i.start.line,this.column=i.start.column,this.position=i,this.source=r[0],this.ruleId=r[1],this.file,this.actual,this.expected,this.url,this.note}}y.prototype.file="";y.prototype.name="";y.prototype.reason="";y.prototype.message="";y.prototype.stack="";y.prototype.fatal=null;y.prototype.column=null;y.prototype.line=null;y.prototype.source=null;y.prototype.ruleId=null;y.prototype.position=null;const x={basename:Z,dirname:v,extname:ee,join:te,sep:"/"};function Z(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');P(t);let n=0,s=-1,r=t.length,i;if(e===void 0||e.length===0||e.length>t.length){for(;r--;)if(t.charCodeAt(r)===47){if(i){n=r+1;break}}else s<0&&(i=!0,s=r+1);return s<0?"":t.slice(n,s)}if(e===t)return"";let o=-1,h=e.length-1;for(;r--;)if(t.charCodeAt(r)===47){if(i){n=r+1;break}}else o<0&&(i=!0,o=r+1),h>-1&&(t.charCodeAt(r)===e.charCodeAt(h--)?h<0&&(s=r):(h=-1,s=o));return n===s?s=o:s<0&&(s=t.length),t.slice(n,s)}function v(t){if(P(t),t.length===0)return".";let e=-1,n=t.length,s;for(;--n;)if(t.charCodeAt(n)===47){if(s){e=n;break}}else s||(s=!0);return e<0?t.charCodeAt(0)===47?"/":".":e===1&&t.charCodeAt(0)===47?"//":t.slice(0,e)}function ee(t){P(t);let e=t.length,n=-1,s=0,r=-1,i=0,o;for(;e--;){const h=t.charCodeAt(e);if(h===47){if(o){s=e+1;break}continue}n<0&&(o=!0,n=e+1),h===46?r<0?r=e:i!==1&&(i=1):r>-1&&(i=-1)}return r<0||n<0||i===0||i===1&&r===n-1&&r===s+1?"":t.slice(r,n)}function te(...t){let e=-1,n;for(;++e<t.length;)P(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":ne(n)}function ne(t){P(t);const e=t.charCodeAt(0)===47;let n=ie(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.charCodeAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function ie(t,e){let n="",s=0,r=-1,i=0,o=-1,h,d;for(;++o<=t.length;){if(o<t.length)h=t.charCodeAt(o);else{if(h===47)break;h=47}if(h===47){if(!(r===o-1||i===1))if(r!==o-1&&i===2){if(n.length<2||s!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){if(d=n.lastIndexOf("/"),d!==n.length-1){d<0?(n="",s=0):(n=n.slice(0,d),s=n.length-1-n.lastIndexOf("/")),r=o,i=0;continue}}else if(n.length>0){n="",s=0,r=o,i=0;continue}}e&&(n=n.length>0?n+"/..":"..",s=2)}else n.length>0?n+="/"+t.slice(r+1,o):n=t.slice(r+1,o),s=o-r-1;r=o,i=0}else h===46&&i>-1?i++:i=-1}return n}function P(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const re={cwd:se};function se(){return"/"}function O(t){return t!==null&&typeof t=="object"&&t.href&&t.origin}function oe(t){if(typeof t=="string")t=new URL(t);else if(!O(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return fe(t)}function fe(t){if(t.hostname!==""){const s=new TypeError('File URL host must be "localhost" or empty on darwin');throw s.code="ERR_INVALID_FILE_URL_HOST",s}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.charCodeAt(n)===37&&e.charCodeAt(n+1)===50){const s=e.charCodeAt(n+2);if(s===70||s===102){const r=new TypeError("File URL path must not include encoded / characters");throw r.code="ERR_INVALID_FILE_URL_PATH",r}}return decodeURIComponent(e)}const T=["history","path","basename","stem","extname","dirname"];class le{constructor(e){let n;e?typeof e=="string"||ce(e)?n={value:e}:O(e)?n={path:e}:n=e:n={},this.data={},this.messages=[],this.history=[],this.cwd=re.cwd(),this.value,this.stored,this.result,this.map;let s=-1;for(;++s<T.length;){const i=T[s];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let r;for(r in n)T.includes(r)||(this[r]=n[r])}get path(){return this.history[this.history.length-1]}set path(e){O(e)&&(e=oe(e)),L(e,"path"),this.path!==e&&this.history.push(e)}get dirname(){return typeof this.path=="string"?x.dirname(this.path):void 0}set dirname(e){V(this.basename,"dirname"),this.path=x.join(e||"",this.basename)}get basename(){return typeof this.path=="string"?x.basename(this.path):void 0}set basename(e){L(e,"basename"),R(e,"basename"),this.path=x.join(this.dirname||"",e)}get extname(){return typeof this.path=="string"?x.extname(this.path):void 0}set extname(e){if(R(e,"extname"),V(this.dirname,"extname"),e){if(e.charCodeAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=x.join(this.dirname,this.stem+(e||""))}get stem(){return typeof this.path=="string"?x.basename(this.path,this.extname):void 0}set stem(e){L(e,"stem"),R(e,"stem"),this.path=x.join(this.dirname||"",e+(this.extname||""))}toString(e){return(this.value||"").toString(e||void 0)}message(e,n,s){const r=new y(e,n,s);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}info(e,n,s){const r=this.message(e,n,s);return r.fatal=null,r}fail(e,n,s){const r=this.message(e,n,s);throw r.fatal=!0,r}}function R(t,e){if(t&&t.includes(x.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+x.sep+"`")}function L(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function V(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function ce(t){return H(t)}const ye=Y().freeze(),M={}.hasOwnProperty;function Y(){const t=W(),e=[];let n={},s,r=-1;return i.data=o,i.Parser=void 0,i.Compiler=void 0,i.freeze=h,i.attachers=e,i.use=d,i.parse=E,i.stringify=A,i.run=S,i.runSync=$,i.process=q,i.processSync=G,i;function i(){const f=Y();let l=-1;for(;++l<e.length;)f.use(...e[l]);return f.data(F(!0,{},n)),f}function o(f,l){return typeof f=="string"?arguments.length===2?(z("data",s),n[f]=l,i):M.call(n,f)&&n[f]||null:f?(z("data",s),n=f,i):n}function h(){if(s)return i;for(;++r<e.length;){const[f,...l]=e[r];if(l[0]===!1)continue;l[0]===!0&&(l[0]=void 0);const c=f.call(i,...l);typeof c=="function"&&t.use(c)}return s=!0,r=Number.POSITIVE_INFINITY,i}function d(f,...l){let c;if(z("use",s),f!=null)if(typeof f=="function")b(f,...l);else if(typeof f=="object")Array.isArray(f)?C(f):g(f);else throw new TypeError("Expected usable value, not `"+f+"`");return c&&(n.settings=Object.assign(n.settings||{},c)),i;function p(u){if(typeof u=="function")b(u);else if(typeof u=="object")if(Array.isArray(u)){const[a,...m]=u;b(a,...m)}else g(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function g(u){C(u.plugins),u.settings&&(c=Object.assign(c||{},u.settings))}function C(u){let a=-1;if(u!=null)if(Array.isArray(u))for(;++a<u.length;){const m=u[a];p(m)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function b(u,a){let m=-1,w;for(;++m<e.length;)if(e[m][0]===u){w=e[m];break}w?(N(w[1])&&N(a)&&(a=F(!0,w[1],a)),w[1]=a):e.push([...arguments])}}function E(f){i.freeze();const l=I(f),c=i.Parser;return j("parse",c),k(c,"parse")?new c(String(l),l).parse():c(String(l),l)}function A(f,l){i.freeze();const c=I(l),p=i.Compiler;return _("stringify",p),D(f),k(p,"compile")?new p(f,c).compile():p(f,c)}function S(f,l,c){if(D(f),i.freeze(),!c&&typeof l=="function"&&(c=l,l=void 0),!c)return new Promise(p);p(null,c);function p(g,C){t.run(f,I(l),b);function b(u,a,m){a=a||f,u?C(u):g?g(a):c(null,a,m)}}}function $(f,l){let c,p;return i.run(f,l,g),B("runSync","run",p),c;function g(C,b){U(C),c=b,p=!0}}function q(f,l){if(i.freeze(),j("process",i.Parser),_("process",i.Compiler),!l)return new Promise(c);c(null,l);function c(p,g){const C=I(f);i.run(i.parse(C),C,(u,a,m)=>{if(u||!a||!m)b(u);else{const w=i.stringify(a,m);w==null||(ae(w)?m.value=w:m.result=w),b(u,m)}});function b(u,a){u||!a?g(u):p?p(a):l(null,a)}}}function G(f){let l;i.freeze(),j("processSync",i.Parser),_("processSync",i.Compiler);const c=I(f);return i.process(c,p),B("processSync","process",l),c;function p(g){l=!0,U(g)}}}function k(t,e){return typeof t=="function"&&t.prototype&&(ue(t.prototype)||e in t.prototype)}function ue(t){let e;for(e in t)if(M.call(t,e))return!0;return!1}function j(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `Parser`")}function _(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `Compiler`")}function z(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function D(t){if(!N(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function B(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function I(t){return he(t)?t:new le(t)}function he(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function ae(t){return typeof t=="string"||H(t)}export{ye as unified};
